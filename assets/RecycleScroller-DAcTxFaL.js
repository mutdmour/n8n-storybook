import{d as L,r as a,f as c,w as N,L as F,g as M,M as K,o as p,a as y,b as w,A as R,F as $,E as A,C as V}from"./vue.esm-bundler-CKZLKMJN.js";const U=L({__name:"RecycleScroller",props:{itemSize:{},items:{},itemKey:{},offset:{default:2}},setup(k){const e=k,i=a(null),x=a(null),_=a(null),S=a({}),u=a(0),g=a(0),b=a(0),l=a({}),m=c(()=>e.items.reduce((t,s,n)=>{const r=s[e.itemKey],o=e.items[n-1],v=o?t[o[e.itemKey]]:0,B=o?l.value[o[e.itemKey]]:0;return t[r]=v+B,t},{})),z=c(()=>{const s=e.items.findIndex(n=>m.value[n[e.itemKey]]>=u.value)-1-e.offset;return s<0?0:s}),C=c(()=>{const t=e.items.findIndex(n=>{const r=m.value[n[e.itemKey]],o=l.value[n[e.itemKey]];return r+o>=u.value+g.value}),s=t+e.offset;return t===-1?e.items.length-1:s}),f=c(()=>e.items.slice(z.value,C.value+1));N(()=>f.value,(t,s)=>{const n=t.filter(r=>!s.find(o=>o[e.itemKey]===r[e.itemKey]));n.length>0&&d(n)});const H=c(()=>{const t=e.items[e.items.length-1],s=t?m.value[t[e.itemKey]]:0,n=t?l.value[t[e.itemKey]]:e.itemSize;return s+n}),P=c(()=>({height:`${H.value}px`})),T=c(()=>({transform:`translateY(${m.value[e.items[z.value][e.itemKey]]}px)`}));F(()=>{E()}),M(()=>{i.value&&(i.value.addEventListener("scroll",q),d(f.value)),window.addEventListener("resize",h),h()});function E(){e.items.forEach(t=>{l.value={...l.value,[t[e.itemKey]]:e.itemSize}})}function d(t){for(const s of t)I(s)}function I(t){K(()=>{const s=t[e.itemKey],n=S.value[s],r=l.value[s],o=n?n.offsetHeight:e.itemSize,v=o-r;l.value={...l.value,[t[e.itemKey]]:o},i.value&&u.value&&(i.value.scrollTop=i.value.scrollTop+v,u.value=i.value.scrollTop)})}function h(){i.value&&(g.value=i.value.offsetHeight,K(()=>{d(f.value)})),b.value=window.innerHeight}function q(){i.value&&(u.value=i.value.scrollTop)}return(t,s)=>(p(),y("div",{ref_key:"wrapperRef",ref:i,class:"recycle-scroller-wrapper"},[w("div",{ref_key:"scrollerRef",ref:x,class:"recycle-scroller",style:R(P.value)},[w("div",{ref_key:"itemsRef",ref:_,class:"recycle-scroller-items-wrapper",style:R(T.value)},[(p(!0),y($,null,A(f.value,n=>(p(),y("div",{key:n[t.itemKey],ref_for:!0,ref:r=>S.value[n[t.itemKey]]=r,class:"recycle-scroller-item"},[V(t.$slots,"default",{item:n,updateItemSize:I})]))),128))],4)],4)],512))}});U.__docgenInfo={exportName:"default",displayName:"RecycleScroller",description:"",tags:{},props:[{name:"itemSize",required:!0,type:{name:"number"}},{name:"items",required:!0,type:{name:"Array",elements:[{name:"Record",elements:[{name:"string"},{name:"string"}]}]}},{name:"itemKey",required:!0,type:{name:"string"}},{name:"offset",required:!1,type:{name:"number"},defaultValue:{func:!1,value:"2"}}],slots:[{name:"default",scoped:!0,bindings:[{name:"item",title:"binding"},{name:"update-item-size",title:"binding"}]}],sourceFiles:["/home/runner/work/n8n-storybook/n8n-storybook/packages/design-system/src/components/N8nRecycleScroller/RecycleScroller.vue"]};export{U as _};
